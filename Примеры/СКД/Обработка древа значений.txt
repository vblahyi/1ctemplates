Процедура ПриИзмененииФлажка(Элемент, Колонка)
	
	ТекущаяСтрока = Элемент.ТекущаяСтрока;      
	ОтметитьТекущуюСтроку(ТекущаяСтрока); 
КонецПроцедуры


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////           ДРЕВО

 
Процедура ОтметитьСтрокиВышеТекущей(ТекущийУзелДерева,Знач Пометка) 
   ОчереднойУзелДерева = ТекущийУзелДерева.Родитель; 
    
   Пока ОчереднойУзелДерева <> Неопределено Цикл 
       ОтмеченныеНаТекущемУровне = ОчереднойУзелДерева.Строки.НайтиСтроки(Новый Структура("Пометка",Пометка)); 
        
       Если ОчереднойУзелДерева.Строки.Количество() = ОтмеченныеНаТекущемУровне.Количество() Тогда 
           ОчереднойУзелДерева["Пометка"] = Пометка; 
	   Иначе 
	   	ОчереднойУзелДерева["Пометка"] = 2; 
       КонецЕсли; 
        
       Пометка = ОчереднойУзелДерева["Пометка"]; 
        
       ОчереднойУзелДерева = ОчереднойУзелДерева.Родитель; 
   КонецЦикла; 
КонецПроцедуры 

Функция ПолучитьОбратнуюОтметку(ТекущаяПометка) 
   Если ТекущаяПометка = 1 Тогда 
       ОбратнаяПометка = 0; 
   ИначеЕсли ТекущаяПометка = 0 Тогда 
       ОбратнаяПометка = 1; 
   Иначе 
       ОбратнаяПометка = 2; 
   КонецЕсли; 
    
   Возврат ОбратнаяПометка; 
КонецФункции 

Процедура ОтметитьСтрокиНижеТекущей(ТекущийУзелДерева,Знач Пометка) 
   Для Каждого СтрокаУзла Из ТекущийУзелДерева.Строки Цикл 
       СтрокаУзла["Пометка"] = ?(Пометка=Неопределено,ПолучитьОбратнуюОтметку(СтрокаУзла["Пометка"]),Пометка); 
       ОтметитьСтрокиНижеТекущей(СтрокаУзла,Пометка); 
   КонецЦикла; 
КонецПроцедуры 

Процедура ОтметитьТекущуюСтроку(ТекущаяСтрока) 
	
	 ОтметитьСтрокиНижеТекущей(ТекущаяСтрока,ТекущаяСтрока.Пометка);     
	 ОтметитьСтрокиВышеТекущей(ТекущаяСтрока,ТекущаяСтрока.Пометка); 
	
КонецПроцедуры 


